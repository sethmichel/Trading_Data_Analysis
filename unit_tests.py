import pandas as pd


# soxl 6:30:15 (price starts at 8.52, it reaches its low after the 15 seconds so I don't miss anything on 1st candle)
[
    {"High": 8.53, "Low": 8.41, "Close": 8.45},
    {"High": 8.61, "Low": 8.32, "Close": 8.59},
    {"High": 8.63, "Low": 8.52, "Close": 8.59},
    {"High": 8.59, "Low": 8.43, "Close": 8.51},
    {"High": 8.51, "Low": 8.32, "Close": 8.32},
    {"High": 8.40, "Low": 8.30, "Close": 8.36},
    {"High": 8.41, "Low": 8.27, "Close": 8.34},
    {"High": 8.36, "Low": 8.27, "Close": 8.27},
    {"High": 8.52, "Low": 8.24, "Close": 8.50}
]

# Complete data structure with all fields
complete_data = [
    {"High": 8.53, "Low": 8.41, "Close": 8.45, "TR": 0.0, "upTR": 0.0, "downTR": 0.0, "upATR": 0.0029, "downATR": 0.0071, "dir_bias": 0.286},
    {"High": 8.61, "Low": 8.32, "Close": 8.59, "TR": 0.0, "upTR": 0.0, "downTR": 0.0, "upATR": 0.0067, "downATR": 0.0061, "dir_bias": 0.524},
    {"High": 8.63, "Low": 8.52, "Close": 8.59, "TR": 0.0, "upTR": 0.0, "downTR": 0.0200, "upATR": 0.0072, "downATR": 0.0052, "dir_bias": 0.578},
    {"High": 8.59, "Low": 8.43, "Close": 8.51, "TR": 0.0199, "upTR": 0.0, "downTR": 0.0, "upATR": 0.0062, "downATR": 0.0045, "dir_bias": 0.578},
    {"High": 8.51, "Low": 8.32, "Close": 8.32, "TR": 0.0, "upTR": 0.0200, "downTR": 0.0, "upATR": 0.0067, "downATR": 0.0039, "dir_bias": 0.635},
    {"High": 8.40, "Low": 8.30, "Close": 8.36, "TR": 0.02, "upTR": 0.0, "downTR": 0.0200, "upATR": 0.0058, "downATR": 0.0047, "dir_bias": 0.549},
    {"High": 8.41, "Low": 8.27, "Close": 8.34, "TR": 0.019, "upTR": 0.0, "downTR": 0.0100, "upATR": 0.0049, "downATR": 0.0055, "dir_bias": 0.474},
    {"High": 8.36, "Low": 8.27, "Close": 8.27, "TR": 0.0099, "upTR": 0.0299, "downTR": 0.0, "upATR": 0.0042, "downATR": 0.0047, "dir_bias": 0.474},
    {"High": 8.52, "Low": 8.24, "Close": 8.50, "TR": 0.0299, "upTR": 0.009, "downTR": 0.0, "upATR": 0.0036, "downATR": 0.0040, "dir_bias": 0.474}
]



# random function not related to this file name
# for figuring out trends in vol % and ratio during consoildation so I can omit consolidation trades from cross data automatically
def focus_stock():
    ticker = 'SMCI'
    start_times = ['6:30:00']
    end_times = ['10:01:00']
    source_csv_path = 'Csv_Files/3_Final_Trade_Csvs/Summary_08-26-2025.csv'
    output_csv_path = 'TESTING.csv'

    # Read the source CSV file
    df = pd.read_csv(source_csv_path)
    
    # Filter rows containing the specified ticker in the 'Ticker' column
    filtered_df = df[df['Ticker'] == ticker]
    
    # Filter rows based on Entry Time being within the specified time ranges
    def is_time_in_range(entry_time_str):
        # Convert entry time string to datetime.time for comparison
        from datetime import datetime
        try:
            entry_time = datetime.strptime(entry_time_str, '%H:%M:%S').time()
            
            # Check if entry time falls within any of the time ranges
            for start_time_str, end_time_str in zip(start_times, end_times):
                start_time = datetime.strptime(start_time_str, '%H:%M:%S').time()
                end_time = datetime.strptime(end_time_str, '%H:%M:%S').time()
                
                # Handle cases where time range crosses midnight
                if start_time <= end_time:
                    # Normal case: start_time < end_time (e.g., 7:30:00 to 10:01:00)
                    if start_time <= entry_time <= end_time:
                        return True
                else:
                    # Crosses midnight: start_time > end_time (e.g., 23:00:00 to 01:00:00)
                    if entry_time >= start_time or entry_time <= end_time:
                        return True
            
            return False
        except ValueError:
            # If time parsing fails, exclude the row
            return False
    
    # Apply time filtering
    time_filtered_df = filtered_df[filtered_df['Entry Time'].apply(is_time_in_range)]
    
    # Select only the specified columns
    selected_columns = [
        'Date', 'Ticker', 'Entry Time', 'Exit Time', 'Time in Trade','Entry Price', 'Exit Price', 'Percent Change',
        'Entry Volatility Percent', 'Entry Volatility Ratio', 
        'Entry Adx28', 'Entry Adx14', 'Entry Adx7', 'result_of_last_3_trades',
        'last_result_must_be_4_minutes'
    ]
    
    # Create new dataframe with only the selected columns
    result_df = time_filtered_df[selected_columns]
    
    # Save the result to the output CSV path
    result_df.to_csv(output_csv_path, index=False)
    
    print(f"Filtered {len(result_df)} rows for ticker '{ticker}' and saved to {output_csv_path}")
    
    return result_df

#focus_stock()





























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































